<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.co.jhta.restaurants_service.mapper.PostMapper">

	<select id="getAllPost" resultType="Post">
		select 
			ID				as id,
			TITLE			as title,
			CONTENT			as content,
			CREATE_DATE		as createDate,
			UPDATE_DATE		as updateDate,
			CUSROMER_ID		as "customer.id",
			STORE_ID		as "store.id",
			REPORT_COUNT	as reportCount,
			DISABLED		as disabled,
			BLOCKED			as blocked
		FROM
			POST
		ORDER BY ID ASC	
	</select>
	
	<select id="getPostById" parameterType="int" resultType="Post">
		select
			ID				as id,
			TITLE			as title,
			CONTENT			as content,
			CREATE_DATE		as createDate,
			UPDATE_DATE		as updateDate,
			CUSROMER_ID		as "customer.id",
			STORE_ID		as "store.id",
			REPORT_COUNT	as reportCount,
			DISABLED		as disabled,
			BLOCKED			as blocked
		from
			POST
		where	
			ID = #{id}
	</select>
	
	<insert id="insertPost" parameterType="Post">
		<selectKey keyProperty="id" resultType="int" order="AFTER">
            SELECT LAST_INSERT_ID()
        </selectKey>
		insert into POST
		(TITLE, CONTENT, CUSTOMER_ID, STORE_ID, REPORT_COUNT, DISABLED, BLOCKED)
		values
		(#{title}, #{content}, #{"customer.id"}, #{"store.id"}, #{reportCount}, #{disabled}, #{blocked})
		
	</insert>
	
	<update id="updatePost" parameterType="int">
		update
            POST
        set
            TITLE = #{title},
            CONTENT = #{content},
            UPDATE_DATE = #{updateDate},
            REPORT_COUNT = #{reportCount},
            DISABLED = #{disabled},
            BLOCKED = #{blocked}
        where
            ID = #{id}
	</update>
	
	<delete id="deletePost" parameterType="int">
		delete from 
			POST
		where 
			ID = #{id}
	</delete>
	
</mapper>